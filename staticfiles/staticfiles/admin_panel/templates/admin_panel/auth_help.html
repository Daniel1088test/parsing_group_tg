{% extends 'admin_panel/base.html' %}

{% block title %}Authentication Help - Admin Panel{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col">
            <h1 class="h3 mb-2 text-gray-800">Telegram Authentication Help</h1>
            <p class="mb-4">Comprehensive guide to setting up and troubleshooting Telegram session authentication</p>
        </div>
        <div class="col-auto">
            <a href="{% url 'sessions_list' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Sessions
            </a>
        </div>
    </div>

    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Authentication Process Overview</h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-8">
                    <p>Authenticating a Telegram session involves several steps:</p>
                    <ol>
                        <li>Creating a session with your phone number</li>
                        <li>Receiving and entering a verification code</li>
                        <li>Providing two-factor authentication password (if enabled)</li>
                        <li>Completing the authorization process</li>
                    </ol>
                    <p>Once authenticated, the session remains valid until it's manually revoked or expires.</p>
                </div>
                <div class="col-md-4 text-center">
                    <div class="p-3 bg-light rounded">
                        <i class="fas fa-key fa-4x text-primary mb-3"></i>
                        <p class="font-weight-bold">Authentication is a one-time process</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-6">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Step-by-Step Guide</h6>
                </div>
                <div class="card-body">
                    <div class="timeline">
                        <div class="timeline-item mb-4">
                            <div class="timeline-marker bg-primary text-white rounded-circle d-inline-block p-2">1</div>
                            <div class="timeline-content ps-3">
                                <h5>Create a New Session</h5>
                                <p>Add a new session with your phone number in the international format (e.g., +123456789012).</p>
                            </div>
                        </div>
                        <div class="timeline-item mb-4">
                            <div class="timeline-marker bg-primary text-white rounded-circle d-inline-block p-2">2</div>
                            <div class="timeline-content ps-3">
                                <h5>Verification Code</h5>
                                <p>Telegram will send a verification code to your Telegram app. Enter this code in the authorization page.</p>
                            </div>
                        </div>
                        <div class="timeline-item mb-4">
                            <div class="timeline-marker bg-primary text-white rounded-circle d-inline-block p-2">3</div>
                            <div class="timeline-content ps-3">
                                <h5>Two-Factor Authentication (If Required)</h5>
                                <p>If you have two-factor authentication enabled, you'll need to provide your password after entering the code.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker bg-success text-white rounded-circle d-inline-block p-2">4</div>
                            <div class="timeline-content ps-3">
                                <h5>Completion</h5>
                                <p>Once authenticated, the session status will change from "Needs Auth" to "Authorized".</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-6">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Troubleshooting</h6>
                </div>
                <div class="card-body">
                    <div class="accordion" id="accordionTroubleshooting">
                        <div class="accordion-item mb-2">
                            <h2 class="accordion-header" id="headingOne">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                    Not Receiving Verification Code
                                </button>
                            </h2>
                            <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionTroubleshooting">
                                <div class="accordion-body">
                                    <ul>
                                        <li>Ensure your phone number is entered correctly in international format</li>
                                        <li>Check that your Telegram app is installed and you're logged in</li>
                                        <li>Try restarting your Telegram app</li>
                                        <li>Wait a few minutes and try again</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item mb-2">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                    Authentication Failure
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionTroubleshooting">
                                <div class="accordion-body">
                                    <ul>
                                        <li>Make sure you entered the verification code correctly</li>
                                        <li>Check if you have two-factor authentication enabled</li>
                                        <li>Try deleting the session and creating a new one</li>
                                        <li>Check if your account has any restrictions</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingThree">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                    Session Keeps Expiring
                                </button>
                            </h2>
                            <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionTroubleshooting">
                                <div class="accordion-body">
                                    <ul>
                                        <li>Telegram may expire sessions if they appear suspicious</li>
                                        <li>Avoid running too many sessions from the same IP address</li>
                                        <li>Check if there are any active sessions in your Telegram app</li>
                                        <li>Consider using a different account for automation</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Telegram API Keys</h6>
        </div>
        <div class="card-body">
            <div class="alert alert-info">
                <i class="fas fa-info-circle"></i> By default, the system uses shared API keys. For better performance and reliability, consider using your own API keys.
            </div>
            
            <h5>Getting Your Own API Keys</h5>
            <ol>
                <li>Visit <a href="https://my.telegram.org/apps" target="_blank">https://my.telegram.org/apps</a></li>
                <li>Log in with your Telegram account</li>
                <li>Fill in the form to create a new application</li>
                <li>Copy the "API ID" and "API Hash" provided</li>
                <li>Enter these values when creating a new session in this system</li>
            </ol>
            
            <p class="text-danger">
                <i class="fas fa-exclamation-triangle"></i> <strong>Important:</strong> Never share your API hash with anyone. Treat it like a password.
            </p>
        </div>
    </div>
</div>

<style>
.timeline-marker {
    width: 30px;
    height: 30px;
    text-align: center;
}
.timeline-content {
    display: inline-block;
    vertical-align: top;
    width: calc(100% - 40px);
}
</style>
{% endblock %}

{% block scripts %}
<script>
    $(document).ready(function() {
        // Initialize Bootstrap components
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        });
    });
</script>
{% endblock %} 